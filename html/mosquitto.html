<!DOCTYPE html>
<html>
<head>
	<title>MQTT over WebSockets</title>
<link rel="stylesheet" type="text/css" href="style.css"/>
<script type='text/javascript' src='mosquitto.js'></script>
<script type='text/javascript' src='jquery.min.js'></script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-28176897-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>
<body>
	<h1>MQTT over WebSockets</h1>
	<p>This is a very early/incomplete/broken example of MQTT over Websockets for
	test.mosquitto.org. Play around with the buttons below, but don't be
	surprised if it breaks or isn't very pretty. If you want to develop your own
	websockets/mqtt app, use the url ws://test.mosquitto.org/mqtt , use
	subprotocol "mqttv3.1" and binary data. Then just treat the websocket as a
	normal socket connection and read/write MQTT packets.</p>
	<p>The server is running a patched version of lighttpd with the third party <a
	href="https://github.com/nori0428/mod_websocket">mod_websocket</a>
	included. If you're on ubuntu you can find packages for the patched lighttpd with mod_websocket at <a href="https://launchpad.net/~roger.light/+archive/ppa">https://launchpad.net/~roger.light/+archive/ppa</a>.</p>
	<h2>Usage</h2>
	<p>Click Connect, then use the Publish and/or Subscribe buttons. You should
	see text appear below. If you've got another mqtt client available, try
	subscribe to a topic here then use your other client to send a message to
	that topic.</p>
<div id="broker">
	<h2>Broker</h2>
	<input class="but" id="connect-button" type="button" value="Connect">
	<input class="but" id="disconnect-button" type="button" value="Disconnect">
</div>
<div id="publish">
	<h2>Publish</h2>
	<p>Topic: <input class="txt" id="pub-topic-text" type="text" value=""></p>
	<p>Payload: <input class="txt" id="payload-text" type="text" value=""></p>
	<input class="but" id="publish-button" type="button" value="Publish">
</div>
<div id="subscribe">
	<h2>Subscribe/Unsubscribe</h2>
	<p>Topic: <input class="txt" id="sub-topic-text" type="text" value="$SYS/#"></p>
	<p>
	<input class="but" id="subscribe-button" type="button" value="Subscribe">
	<input class="but" id="unsubscribe-button" type="button" value="Unsubscribe">
	</p>
</div>
<div id="debug"></div>

	<script src="tmo.js" type="text/javascript"></script>
</body>
</html>
